import{_ as e,c as s,o as a,O as o}from"./chunks/framework.8e4cc2b6.js";const D=JSON.parse('{"title":"System CUI components","description":"","frontmatter":{},"headers":[],"relativePath":"reference/annotations/systemcomponent.md","lastUpdated":1682392529000}'),t={name:"reference/annotations/systemcomponent.md"},n=o(`<h1 id="system-cui-components" tabindex="-1">System CUI components <a class="header-anchor" href="#system-cui-components" aria-label="Permalink to &quot;System CUI components&quot;">​</a></h1><h2 id="motivation" tabindex="-1">Motivation <a class="header-anchor" href="#motivation" aria-label="Permalink to &quot;Motivation&quot;">​</a></h2><p>One of the design goal of OpenCUI is to automatically handle many conversational issues: where user digress, how we bring them back on track, or where there are ambiguity, how we disambiguate through dynamically scheduled clarification.</p><p>Ideally we expect that you don‘t need to worry how they are triggered, and for most part you do not even need to do much as system CUI components will provide good default behaviors. But if needed you can customize the expression and script to tinker the behavior.</p><p>And the OpenCUI solution is based on aspect oriented programming. It does so by adding additional behavior (via system CUI components) to existing code (an advice) without modifying the code itself, instead separately specifying which code is modified via a &quot;pointcut&quot; specification (triggered by runtime automatically). The common system CUI are, and as time goes by, we will surely have more of these to enrich the default chatbot behavior.</p><h2 id="clarification" tabindex="-1">Clarification <a class="header-anchor" href="#clarification" aria-label="Permalink to &quot;Clarification&quot;">​</a></h2><p>Often time, user might say something that dialog understanding did not fully understand, for example, there are multiple possibilities. These are the time when we can trigger system skill to engage in the conversation for user to clarify what they really meant. There are couple variants of this:</p><h3 id="value-clarification" tabindex="-1">Value clarification <a class="header-anchor" href="#value-clarification" aria-label="Permalink to &quot;Value clarification&quot;">​</a></h3><p>During the slot filling, particularly when we try to find value from the conversation history, there might be multiple values that can be used to fill the slot. This CUI component is used to ask user decide which one is what they want.</p><p>For example, on the way to booking a flight, if the user asks about the weather and the bot cannot determine which city the user is asking about as there are more than one cities in the context. <strong>Value Clarification</strong> can help the bot to ask the user for disambiguation.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Book one ticket from beijing to seattle.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What time would you like to leave?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What is the weather going to be like tomorrow?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Which city would you like to check?</span></span>
<span class="line"><span style="color:#C3E88D;">          - Beijing</span></span>
<span class="line"><span style="color:#C3E88D;">          - Seattle</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Beijing</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><h3 id="slot-clarification" tabindex="-1">Slot clarification <a class="header-anchor" href="#slot-clarification" aria-label="Permalink to &quot;Slot clarification&quot;">​</a></h3><p>When a user mentions a value that can fill more than one open slot, instead of just filling a slot directly and moving on, the bot should perform the act of disambiguation by asking which slot the user wants to fill with the help of Slot Clarification.</p><p>For example, when a user says something like <em>&quot;book a flight, beijing&quot;</em>, in some cases, the bot might need to say &quot;what do you mean by beijing, departure or destination?&quot; instead of filling one slot with Beijing randomly.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Book a flight, beijing</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What do you mean by beijing, departure or destination?</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><h3 id="intent-clarification" tabindex="-1">Intent clarification <a class="header-anchor" href="#intent-clarification" aria-label="Permalink to &quot;Intent clarification&quot;">​</a></h3><p>Intent Clarification is a simple intent clarification mechanism that can automatically resolve stuck conversations when DU is not 100% sure about its understanding of user utterance. It will be triggered when there are multiple possibly-good answers.</p><p>For example, when a user says: <em>&quot;I am hungry&quot;</em> to a virtual restaurant chatbot and there are potentially multiple understanding candidates for this utterance, the bot will clarify the right one with the user by showing the list of understanding candidates like &quot;do you want me to order food or reserve a table at your favorite restaurant?&quot;</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">I am hungry</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Do you want me to order food or reserve a table at your favorite restaurant?</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><h2 id="slot-update" tabindex="-1">Slot update <a class="header-anchor" href="#slot-update" aria-label="Permalink to &quot;Slot update&quot;">​</a></h2><p>Slot update is a system skill that is designed to provide the default behavior for users wanting to modify the value of the previous specified slot. For example, when a user changes his mind during booking a flight, the user might say <em>&quot;I need to change the destination from Beijing to Shanghai&quot;</em>. Then the bot will modify the value of destination and always execute the same interaction logic as if that slot is filled for the first time.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Need to change the destination from beijing to shanghai.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Sure. Your destination is changed from Beijing to Shanghai.</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>If the user&#39;s expression is ambiguous like <em>&quot;Wait, I think Shanghai is better&quot;</em>, or the user only mentioned part of the information like <em>&quot;I need to change the destination&quot;</em>, the bot will clarify the right value with the user with the help of slot update.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Need one way ticket to beijing pls</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Let&#39;s find a one-way ticket for you. Which date do you want to fly?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Wait, I think shanghai is better.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">So you want to change your destination to Shanghai?</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><h2 id="binary-gate" tabindex="-1">Binary gate <a class="header-anchor" href="#binary-gate" aria-label="Permalink to &quot;Binary gate&quot;">​</a></h2><p>Binary Gate is an interaction that needs the user to answer boolean questions for different purposes, so that bot can know whether it needs to collect predefined slots or not.</p><p>While it is possible to add a boolean slot to act like binary gate for some slot, and use its value <code>true</code> or <code>false</code> to control whether the bot prompts users for that slot or takes an action. But the bot also needs to know the answer other than yes/no, such as the value of the nested slots.</p><p><strong>Binary Gate</strong> can let DU know where the expectation is the gate, the slot it controls is also active, so DU can understand the common usage instead of do weird things like keep asking questions until it gets the right answer or can not understand the value provided by the user.</p><p>To reduce the effort level for dealing with these understanding problems, here are some default behaviors to handle the responses to yes/no questions:</p><ol><li><p>Simple yes/no can be automatically taken care of by <code>kotlin.Boolean</code> entity, like <em>&quot;yes&quot;</em>, <em>&quot;yeah&quot;</em>, <em>&quot;no&quot;</em>, <em>&quot;nope&quot;</em>. It means you do not need to enter the same patterns over and over again. But you can provide more expression exemplars in <code>kotlin.Boolean</code> entity to customize the global yes/no behaviors. These behaviors will work throughout the entire chatbot.</p></li><li><p>To customize the positive and negative exemplars in specific context, you need to add the relevant annotations like <strong>Multi-valued</strong>, <strong>Confirmation</strong>, <strong>Gated</strong> and provide exemplars of expressions in the specific Affirmatives and Negatives expressions such as <code>$value$ is my favorite</code>, <code>Sorry I need to change</code>.</p></li></ol><h3 id="hasmore" tabindex="-1">hasMore <a class="header-anchor" href="#hasmore" aria-label="Permalink to &quot;hasMore&quot;">​</a></h3><p><code>hasMore</code> is a reusable component designed specifically for multi-value slots. For example, tasks are multi-valued in chatbots. So when a task is completed, the bot will ask the user if he still needs help. Where</p><ul><li><em>&quot;Yes&quot;</em> continues the conversation by asking the slot prompts you defined, for example:</li></ul><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Is there anything else I can help you with today?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Yes.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">How can I assist you?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Need one way ticket to beijing pls</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><ul><li><em>&quot;No&quot;</em> goes to the next step. In this case, the bot will send a good-bye message and close the conversation.</li></ul><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Is there anything else I can help you with today?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">No, thanks</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Thank you for contacting the virtual Restaurant chatbot. I am glad I could help you today. Good-bye!</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><ul><li><em>&quot;Slot Value&quot;</em> assumes the gate is opened and start to fill slot with uesr input, for example:</li></ul><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Is there anything else I can help you with today?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Need one way ticket to beijing pls</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Let&#39;s find a one-way ticket for you. Which date do you want to fly?</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><h3 id="confirmation" tabindex="-1">confirmation <a class="header-anchor" href="#confirmation" aria-label="Permalink to &quot;confirmation&quot;">​</a></h3><p><code>confirmation</code> is a well known component which asks the user to verify that they want to proceed with an action. It may be paired with a warning or critical information related to that action. For example, when a user wants to cancel an order, you should double-check with the user prior to performing an action that would be difficult to undo:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Can I cancel an order?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Sure. Could you provide me with the order number?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">I found the order: [order details]. Should I go ahead and Cancel the order?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Yes.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">I have cancelled the order for you. </span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>Where <em>&quot;yes&quot;</em> continues the action, <em>&quot;no&quot;</em> renews the slot, <em>&quot;value&quot;</em> changes the old value then confirm with the user. For more information about confirmation annotation, see <a href="./confirmation.html">Confirmation</a>.</p><h3 id="booleangate" tabindex="-1">booleanGate <a class="header-anchor" href="#booleangate" aria-label="Permalink to &quot;booleanGate&quot;">​</a></h3><p><code>booleanGate</code> is a component which is mainly used as a binary gate to decide whether it needs to fill the nested slot or skip the nested slot. For example, when checking out, the bot will ask the user whether to use some coupon. While some people might not have it, this binary gate could be useful:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Do you have some promo code?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Yes.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What is your promo code?</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>If the answer is slot value, the gate will be opened and the bot will start to fill nested slots with user input. So the bot can understand the common usage such as the value of the nested slot promo code naturally:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Do you have some promo code?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">XXXXXX</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Okay lets go ahead and begin checkout...</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>Otherwise, the bot will keep asking the yes/no question until it gets the right answer.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Do you have some promo code?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">XXXXXX</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Do you have some promo code?</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>For more information about Boolean Gate annotation, see <a href="./fillstrategy.html#gated">Gated</a>.</p><h2 id="user-identifier" tabindex="-1">User identifier <a class="header-anchor" href="#user-identifier" aria-label="Permalink to &quot;User identifier&quot;">​</a></h2><p>User identifier is a system frame that provides basic information of the user in a channel-dependent way. Once you&#39;ve added a slot of which type is <a href="https://build.opencui.io/org/io.opencui/agent/core/struct/frame/633f953f28e4f04b5f84453e" target="_blank" rel="noreferrer"><code>user.UserIdentifier</code></a>, when the user chats with bot in a channel, the bot can access the user ID, the type and the label of the channel. For example, in the <a href="./../channels/whatsapp.html">WhatsApp</a> channel, the user ID is the same as the user&#39;s phone number, the type of the channel is <em>whatsApp</em> and the label of the channel is defined by the chatbot builder.</p><p>With the information from user identifier, it&#39;s convenient for business to manage users along with their requests. For example, when the bot has confirmed the reservation information with users, it could store the reservation under the user ID and send the user ID back to the user. When the user comes for dinner, that ID can be used to get the reserved table.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Are you sure to book a small table at 10:00 AM for Wednesday, December 14, 2022?</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">User: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Yes.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Chatbot: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Your reservation is secured. Thank you very much for making the reservation! You can check the reservation under your id: 1202555xxxx.</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div>`,54),l=[n];function i(r,p,c,h,u,d){return a(),s("div",null,l)}const m=e(t,[["render",i]]);export{D as __pageData,m as default};
